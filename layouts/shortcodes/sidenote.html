{{ $key := "sidenote index" }}

{{- if not (.Page.Scratch.Get $key) -}}
{{ .Page.Scratch.Set $key 1 }}
{{- end -}}

{{- if not (.Page.Scratch.Get "sidenotes") -}}
{{ .Page.Scratch.Set "sidenotes" slice }}
{{- end -}}
{{ .Page.Scratch.Set "sidenotes" (.Page.Scratch.Get "sidenotes" | append .Inner )}}


{{ $index := .Page.Scratch.Get $key}}
<label for="sidenote-checkbox-{{$index}}" class="sidenote-label">{{ .Get 0 }} <sup>{{ $index }}</sup></label>
<input type="checkbox" class="sidenote-checkbox" id="sidenote-checkbox-{{$index}}">
<span class="sidenote"><strong>{{ $index }}.</strong> {{ .Inner | markdownify }}</span>

{{ .Page.Scratch.Set $key (add (.Page.Scratch.Get $key) 1) }}